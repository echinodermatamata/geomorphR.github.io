library(geomorph)
lizards <- readland.tps('LectureData/07.allometry/symm.shape2.tps', warnmsg = FALSE)
liz.lab <- read.csv('LectureData/07.allometry/ind.info.txt',header=TRUE, sep=",")
col.gp <- rep("black",nrow(liz.lab))
col.gp[which(liz.lab$type=='U')] <- 'red'
Y.gpa <- gpagen(lizards, print.progress = FALSE)
CS <- liz.lab$cs
type <- as.factor(liz.lab$type)
gdf <- geomorph.data.frame(Y.gpa, CS = CS, type = type)
plotAllSpecimens(Y.gpa$coords)
fit <- procD.lm(Y.gpa$coords~CS*type, data = gdf, print.progress = FALSE)
anova(fit)$table
PCA <- gm.prcomp(Y.gpa$coords)
plot(PCA,pch = 21, bg=col.gp,cex = 2)
legend("topleft", levels(gdf$type), pch = 21, pt.bg = unique(col.gp))
par(mfrow=c(1,2))
plot(fit, type = "regression", predictor = gdf$CS,
reg.type = "RegScore", pch=19, col = col.gp)
legend("topleft", levels(gdf$type), pch = 21, pt.bg = unique(col.gp))
mtext("Regression Scores")
plot(fit, type = "regression", predictor = gdf$CS,
reg.type = "PredLine", pch=19, col = col.gp)
legend("topleft", levels(gdf$type), pch = 21, pt.bg = unique(col.gp))
mtext("Predicted Lines")
par(mfrow=c(1,1))
# Shape predictor part. Is it correct?
preds <- shape.predictor(fit$GM$fitted, x= gdf$CS, Intercept = TRUE,
predmin.u = min(gdf$CS),
predmax.u = max(gdf$CS),
predmin.r = min(gdf$CS),
predmax.r = max(gdf$CS))
# Shape predictor part. Is it correct?
X <- fit$X
X <- X[,-1]
CS.min.max <- by(gdf$CS,gdf$type,range)
R.min <- c(CS.min.max$R[1], 0, 0)
R.max <- c(CS.min.max$R[2], 0, 0)
U.min <- c(CS.min.max$U[1], 0, CS.min.max$U[1])
U.max <- c(CS.min.max$U[2], 0, CS.min.max$U[2])
preds <- shape.predictor(fit$GM$fitted, x= X, Intercept = TRUE,
predmin.r = R.min,
predmax.r = R.max,
predmin.u = U.min,
predmax.u = U.max)
M <- mshape(Y.gpa$coords)
par(mfrow=c(2,2))
plotRefToTarget(M, preds$predmin.r, mag = 1)
mtext("Rural Min")
plotRefToTarget(M, preds$predmax.r, mag = 1)
mtext("Rural Max")
plotRefToTarget(M, preds$predmin.u, mag = 1)
mtext("Urban Min")
plotRefToTarget(M, preds$predmax.u, mag = 1)
mtext("Urban Max")
par(mfrow=c(1,1))
coords.subset
?coords.subset
?compare.CR
#### check: typical urban/rural
shape.gps <- coords.subset(fit$GM$fitted,type)
mn <- Map(function(x) mshape,shape.gps)
shape.gps <- coords.subset(fit$GM$fitted,type)
#### check: typical urban/rural
shape.gps <- coords.subset(fit$GM$fitted,type)
mn <- Map(function(x) mshape,shape.gps)
plotRefToTarget(M,mn$R
plotRefToTarget(M,mn$R)
mn$R
typ
type
plotAllSpecimens(shape.gps$R)
plotAllSpecimens(shape.gps$U)
mn <- Map(function(x) mshape(x),shape.gps)
plotRefToTarget(M,mn$R)
plotRefToTarget(M,mn$U)
coords.subset(gdf$CS,type)
CS.R <-
which(type=="R")
which(type=="R")
CS.R <- gdf$CS[which(type=="R")]
CS.U <-   gdf$CS[which(type=="U")]
predsR <- shape.predictor(shape.gps$R,x = CS.R, Intercept = TRUE,
predmin = min(CS.R),
predmax = max(CS.R))
plotRefToTarget(M,predsR$predmin)
plotRefToTarget(M,predsR$predmax)
predsU <- shape.predictor(shape.gps$U,x = CS.U, Intercept = TRUE,
predmin = min(CS.U),
predmax = max(CS.U))
plotRefToTarget(M,predsR$predmin, mag = 2)
plotRefToTarget(M,predsU$predmin, mag = 2)
plotRefToTarget(M,predsR$predmax, mag = 2)
plotRefToTarget(M,predsU$predmax, mag = 2)
