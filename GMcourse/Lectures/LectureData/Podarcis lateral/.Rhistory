library(geomorph)
lizards <- readland.nts('lizards_LAT.nts')
lizards
dim(lizards)
links <- read.csv('links.txt')
links
Y.gpa <- gpagen(lizards)
plotAllSpecimens(Y.gpa$coords)
plotAllSpecimens(lizards)
plotAllSpecimens(lizards, links=links)
plotAllSpecimens(lizards, links = links)
links <- read.csv('links.txt', header=FALSE)
di(links)
dim(links)
links
links <- read.csv('links.txt', header=FALSE, sep = " ")
dim(links)
plotAllSpecimens(lizards, links = links)
plotAllSpecimens(Y.gpa$coords, links=links)
#############
# shape spaces:
n=2000
p=3
k=2
tri<- arrayspecs(matrix(rnorn(n*p*k),nrows=n),p=p,k=k)
library(geomorph)
tri<- arrayspecs(matrix(rnorn(n*p*k),nrows=n),p=p,k=k)
tri<- arrayspecs(matrix(rnorn(n*p*k),nrow=n),p=p,k=k)
tri<- arrayspecs(matrix(rnorm(n*p*k),nrow=n),p=p,k=k)
dim(tri)
tri.gpa <- gpagen(tri,Proj = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot(pc.tri[,1:2])
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
library(scatterplot3d)
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3])
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1)
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21, bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],-pc.tri[,3], asp=1, pch=21, bg="red")
#############
# shape spaces:
n=5000
p=3
k=2
tri<- arrayspecs(matrix(rnorm(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],-pc.tri[,3], asp=1, pch=21, bg="red")
#############
# shape spaces:
n=1000
p=3
k=2
tri<- arrayspecs(matrix(rnorm(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],-pc.tri[,3], asp=1, pch=21, bg="red")
#############
# shape spaces:
n=2000
p=3
k=2
tri<- arrayspecs(matrix(rnorm(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],-pc.tri[,3], asp=1, pch=21, bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21, bg="red")
#############
# shape spaces:
n=2000
p=3
k=2
seed = 2
tri<- arrayspecs(matrix(rnorm(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21, bg="red")
seed = 4
tri<- arrayspecs(matrix(rnorm(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21, bg="red")
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21, cex=.6,bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red")
?scatterplot3d
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE)
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, axis=FALSE)
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, xlab=FALSE)
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, xlab=NULL)
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE, xlab=NULL)
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
plot(pc.tri[,1],pc.tri[,2], asp=1, pch=21, bg="red")
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
liz.lab <- read.csv('liz_groups.csv',header=TRUE)
liz.lab
liz.lab <- read.csv('liz_groups.csv',header=TRUE, sep="\t")
lib.lab
liz.lab
liz.lab$SEX
?plotAllSpecimens
plotAllSpecimens(lizards, links = links, plot.param = list(c(pt.bg=liz.lab)))
lizards <- readland.nts('lizards_LAT.nts')
links <- read.csv('links.txt', header=FALSE, sep = " ")
liz.lab <- read.csv('liz_groups.csv',header=TRUE, sep="\t")
Y.gpa <- gpagen(lizards, print.progress = FALSE)
plotAllSpecimens(lizards, links = links, plot.param = list(c(pt.bg=liz.lab)))
plotAllSpecimens(Y.gpa$coords, links=links)
plotAllSpecimens(lizards, links = links)
plotAllSpecimens(Y.gpa$coords, links=links)
setwd("C:/DeanData/Teaching/Workshops/2019-Chile/2019-Chile/Lectures")
n=2000
p=3
k=2
seed = 2
tri<- arrayspecs(matrix(runif(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE, print.progress = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
plot(pc.tri[,1:2], asp=1, pch=21, bg="red")
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
pc.tri[,3]
range(pc.tri[,3])
tri<- arrayspecs(matrix(runif(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE, print.progress = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
range(pc.tri[,3])
tri<- arrayspecs(matrix(runif(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE, print.progress = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
range(pc.tri[,3])
tri<- arrayspecs(matrix(runif(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE, print.progress = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
range(pc.tri[,3])
tri<- arrayspecs(matrix(runif(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE, print.progress = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
range(pc.tri[,3])
tri<- arrayspecs(matrix(runif(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE, print.progress = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
range(pc.tri[,3])
which.min(abs(range(pc.tri[,3])))
mult.pc <- ifelse(which.min(abs(range(pc.tri[,3])))=1{-1,1}
mult.pc <- ifelse(which.min(abs(range(pc.tri[,3])))==1{-1,1}
mult.pc <- ifelse(which.min(abs(range(pc.tri[,3])))==1){-1,1}
mult.pc <- ifelse(which.min(abs(range(pc.tri[,3])))==1-1,1)
mult.pc <- ifelse(which.min(abs(range(pc.tri[,3])))==1,-1,1)
mult.pc
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],mult.pc*pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
seed = 2
tri<- arrayspecs(matrix(runif(n*p*k),nrow=n),p=p,k=k)
tri.gpa <- gpagen(tri,Proj = FALSE, print.progress = FALSE)
pc.tri <- prcomp(two.d.array(tri.gpa$coords))$x
mult.pc <- ifelse(which.min(abs(range(pc.tri[,3])))==1,-1,1)
mult.pc
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],mult.pc*pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
plot<-scatterplot3d(pc.tri[,1],pc.tri[,2],pc.tri[,3], asp=1, pch=21,bg="red",
tick.marks = FALSE, box=FALSE)
geomorph:::phylo.mat
e <= matrix(c(.721, -.721,.721,-.721,-.721, .721,-.721,.721,.721, -.721,.721,-.721,-.721, .721,-.721,.721)),byrow=T,ncol=4)
e <- matrix(c(.721, -.721,.721,-.721,-.721, .721,-.721,.721,.721, -.721,.721,-.721,-.721, .721,-.721,.721)),byrow=T,ncol=4)
c(.721, -.721,.721,-.721,-.721, .721,-.721,.721,.721, -.721,.721,-.721,-.721, .721,-.721,.721)
matrix(c(.721, -.721,.721,-.721,-.721, .721,-.721,.721,.721, -.721,.721,-.721,-.721, .721,-.721,.721),ncol=4)
matrix(c(.721, -.721,.721,-.721,-.721, .721,-.721,.721,.721, -.721,.721,-.721,-.721, .721,-.721,.721),ncol=4)->E
E
eigen(E)$vectors
eigen(E)$values
plotAllSpecimens(tri.gpa$coords)
tri.gpa2 <- gpagen(tri, print.progress = FALSE)
plotAllSpecimens(tri.gpa2$coords)
dist.shape <- dist(two.d.array(tri.gpa$coords))
dist.Kendall <- dist(two.d.array(tri.gpa2$coords))
cor(dist.shape,dist.Kendall)
plot(dist.shape,dist.Kendall)
#shape variable comparison
Kendall.d <- dist(two.d.array(Y.gpa$coords))
library(geomorph)
library(scatterplot3d)
lizards <- readland.nts('lizards_LAT.nts')
links <- read.csv('links.txt', header=FALSE, sep = " ")
liz.lab <- read.csv('liz_groups.csv',header=TRUE, sep="\t")
Y.gpa <- gpagen(lizards, print.progress = FALSE)
setwd("C:/DeanData/Teaching/Workshops/2019-Chile/2019-Chile/Lectures/Podarcis lateral")
lizards <- readland.nts('lizards_LAT.nts')
links <- read.csv('links.txt', header=FALSE, sep = " ")
liz.lab <- read.csv('liz_groups.csv',header=TRUE, sep="\t")
Y.gpa <- gpagen(lizards, print.progress = FALSE)
plotAllSpecimens(lizards, links = links)
plotAllSpecimens(Y.gpa$coords, links=links)
#shape variable comparison
Kendall.d <- dist(two.d.array(Y.gpa$coords))
Y.gpa2 <- gpagen(lizards, proj = FALSE, print.progress = FALSE)
GPA.d <- dist(two.d.array(Y.gpa2$coords))
Y.gpa2 <- gpagen(lizards, Proj = FALSE, print.progress = FALSE)
GPA.d <- dist(two.d.array(Y.gpa2$coords))
cor(Kendall.d,GPA.d)
plot(GPA.d,Kendall.d)
27*7
#Need PCA, and male/female TPS
plotTangentSpace(Y.gpa$coords,warpgrids = FALSE, groups=liz.lab$SEX)
col.gp <- rep("red",ncol(liz.lab))
col.gp
col.gp <- rep("red",nrow(liz.lab))
col.gp
which(liz.lab$SEX==M)
liz.lab$SEX
which(liz.lab$SEX==M)
which(liz.lab$SEX=='M')
col.gp[which(liz.lab$SEX=='M')] <- 'blue'
#Need PCA, and male/female TPS
plotTangentSpace(Y.gpa$coords,warpgrids = FALSE, groups=col.gp)
plotTangentSpace(Y.gpa$coords,warpgrids = FALSE, groups=col.gp)
plotTangentSpace(Y.gpa$coords,warpgrids = FALSE, groups=col.gp,legend = TRUE)
plotTangentSpace(Y.gpa$coords,warpgrids = FALSE, groups=col.gp)->res
plotTangentSpace(Y.gpa$coords,warpgrids = FALSE, groups=col.gp)->res
###male/female means
gdf <- geomorph.data.frame(Y.gpa, gp = liz.lab$SEX)
res <- procD.lm(Y.gpa$coords~gp, data = gdf, iter = 1, print.progress = FALSE)
res$fitted
###male/female means
male <- mshape(Y.gpa$coords[,,which(liz.lab$SEX=='M')])
male
female <- mshape(Y.gpa$coords[,,which(liz.lab$SEX=='F')])
plotRefToTarget(male,female,links = links)
plotRefToTarget(male,female,links = links, mag = 2)
plotRefToTarget(male,female,links = links, mag = 5)
