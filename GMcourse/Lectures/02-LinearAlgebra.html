<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>2. Linear Algebra</title>
    <meta charset="utf-8" />
    <meta name="author" content="" />
    <script src="02-LinearAlgebra_files/header-attrs-2.19/header-attrs.js"></script>
    <script src="02-LinearAlgebra_files/htmlwidgets-1.6.1/htmlwidgets.js"></script>
    <link href="02-LinearAlgebra_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="02-LinearAlgebra_files/datatables-binding-0.27/datatables.js"></script>
    <script src="02-LinearAlgebra_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="02-LinearAlgebra_files/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="02-LinearAlgebra_files/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="02-LinearAlgebra_files/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
    <link href="02-LinearAlgebra_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="02-LinearAlgebra_files/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# 2. Linear Algebra
]
.subtitle[
## AKA: The important foundation for everything that follows!
]
.author[
### 
]

---




### Linear Algebra: Goals

Understand why this equation is a foundational equation used in geometric morphometrics (GM) 

`$$\small\mathbf{Z}=[tr[\mathbf{(Y-\overline{Y})(Y-\overline{Y})^T}]]^{-1/2}\mathbf{(Y-\overline{Y})H}$$`
---

### Linear Algebra: Goals

Understand why this equation is a foundational equation used in geometric morphometrics (GM) 

`$$\small\mathbf{Z}=[tr[\mathbf{(Y-\overline{Y})(Y-\overline{Y})^T}]]^{-1/2}\mathbf{(Y-\overline{Y})H}$$`


Understand why this equation is a foundational equation in multivariate statistics (and burn it into your memory)

`$$\hat{\mathbf{B}}=\left ( \mathbf{\tilde{X}}^{T} \mathbf{\tilde{X}}\right )^{-1}\left ( \mathbf{\tilde{X}}^{T} \mathbf{\tilde{Y}}\right )$$`
---

### Linear Algebra: Goals

Understand why this equation is a foundational equation used in geometric morphometrics (GM) 

`$$\small\mathbf{Z}=[tr[\mathbf{(Y-\overline{Y})(Y-\overline{Y})^T}]]^{-1/2}\mathbf{(Y-\overline{Y})H}$$`


Understand why this equation is a foundational equation in multivariate statistics (and burn it into your memory)

`$$\hat{\mathbf{B}}=\left ( \mathbf{\tilde{X}}^{T} \mathbf{\tilde{X}}\right )^{-1}\left ( \mathbf{\tilde{X}}^{T} \mathbf{\tilde{Y}}\right )$$`

Understand why this equation is a universal equation for describing the alignment of shape data (or any multivariate data) to an alternative set of data, covariance structure, or model

`$$\mathbf{A}^T\mathbf{Z} =\mathbf{UDV}^T$$`
---

### Overview:
- Scalars and Vectors
- Vector addition and subtraction
- Vector multiplication
- Matrices (collections of vectors)
- Special Matrices
- Matrix inversion
- Special Matrix Properties
- General Linear Model Preview
- Sums of Squares and Cross-products
- Covariance matrices
- Decompositions
- Summary
---










### Scalars and Vectors

Scalars
 
`$$a = 5$$`   `$$b = 2$$`   `$$c = -3$$`

Vectors
 
`$$\mathbf{a} = \begin{bmatrix}
 5 \\ 
 3 \\ 
 -2 
\end{bmatrix}$$`

`$$\mathbf{a}^T = \begin{bmatrix}
 5 &amp; 3 &amp; -2
\end{bmatrix}$$`

The superscript, `\(^T\)`, means vector transpose.  Note, `\(\left(\mathbf{a}^T \right)^T = \mathbf{a}\)`

---
### Scalars and Vectors (cont.)

Vector addition/subtraction (consistent orientation is important)

`$$\mathbf{b}^T = \begin{bmatrix}
 -5 &amp; 0 &amp; 1
\end{bmatrix}$$`

`$$\mathbf{a}^T + \mathbf{b}^T= \begin{bmatrix}
 0 &amp; 3 &amp; -1
\end{bmatrix}$$`

`$$\mathbf{a} - \mathbf{b} = \begin{bmatrix}
 10 \\ 3 \\ -3
\end{bmatrix}$$`

---
### Vector Multiplication

#### Not this!

`$$\mathbf{a}^T = \begin{bmatrix}
 5 &amp; 3 &amp; -2
\end{bmatrix}$$`

`$$\mathbf{b}^T = \begin{bmatrix}
 -5 &amp; 0 &amp; 1
\end{bmatrix}$$`

`$$\mathbf{a}^T \times \mathbf{b}^T= \begin{bmatrix}
 -25 &amp; 0 &amp; -2
\end{bmatrix}$$`

But it is kind of that, in part...

---

### Vector Multiplication (cont.)

Vector multiplication is both multiplication and summation of scalars.  Before performing vector multiplication, there has to be consistency with **inner dimensions**.

- Dimensions `\(\mathbf{a}: 3 \times 1\)`

- Dimensions `\(\mathbf{a}^T: 1 \times 3\)`

- Dimensions `\(\mathbf{b}: 3 \times 1\)`

- Dimensions `\(\mathbf{b}^T: 1 \times 3\)`

For any vector product, arrange the dimensions for the attempted product and see if inner dimensions match; e.g., 
`$$\mathbf{a} \times \mathbf{b}: 3 \times \color{blue} {1 \times 3} \times 1$$`
Does not match, so this product is not possible

---

### Vector Multiplication (cont.)

Vector multiplication is both multiplication and summation of scalars.  Before performing vector multiplication, there has to be consistency with **inner dimensions**.

- Dimensions `\(\mathbf{a}: 3 \times 1\)`

- Dimensions `\(\mathbf{a}^T: 1 \times 3\)`

- Dimensions `\(\mathbf{b}: 3 \times 1\)`

- Dimensions `\(\mathbf{b}^T: 1 \times 3\)`

For any vector product, arrange the dimensions for the attempted product and see if inner dimensions match; e.g., 
`$$\mathbf{a}^T \times \mathbf{b}: 1 \times \color{blue} {3 \times 3} \times 1$$`
**This matches!** Multiplication is possible.

---
### Vector Multiplication (cont.): Vector Inner-products

If inner dimensions match, the multiplication is possible.  The product has dimensions equal to the outer dimensions of the match.  There are two types of products:

- Inner-product: the vector product results is a single scalar, i.e., the outer dimensions are `\(1 \times 1\)`

- Outer-product: the vector product results in a series of scalar products with number and arrangement defined by outer dimensions
---

### Vector Multiplication (cont.): Vector Inner-products  (cont.)

#### Vector Inner-Product

For `\(n \times 1\)` vectors

`$$\mathbf{a}^T \mathbf{b} = \sum_{i=1}^n a_ib_i$$`

For example, 
`$$\mathbf{a}^T = \begin{bmatrix}
 5 &amp; 3 &amp; -2
\end{bmatrix}$$`

`$$\mathbf{b} = \begin{bmatrix}
 -5 \\ 0 \\ 1
\end{bmatrix}$$`

`$$\mathbf{a}^T \mathbf{b} = \left(5\times -5 \right) + \left(3 \times 0 \right) + \left(-2 \times 1 \right) = -27$$`

###### *Helpful mnemonic: "Run Amok Computational Demon!" for row-accross and column-down pattern (will be helpful for matrices)*
---
### Vector Multiplication (cont.): Vector Outer Products

If inner dimensions match, the multiplication is possible.  The product has dimensions equal to the outer dimensions of the match.  There are two types of products:

- Inner-product: the vector product results is a single scalar, i.e., the outer dimensions are `\(1 \times 1\)`

- Outer-product: the vector product results in a series of scalar products with number and arrangement defined by outer dimensions
---
#### Vector Outer-Product

For `\(n \times 1\)` vectors

`$$\mathbf{a}\mathbf{b}^T  = \begin{bmatrix}
a_1b_1 &amp; a_1b_2 &amp; a_1b_3 &amp; \cdots &amp; a_1b_n\\
a_2b_1 &amp; a_2b_2 &amp; a_2b_3 &amp; \cdots &amp; a_2b_n\\
a_3b_1 &amp; a_3b_2 &amp; a_3b_3 &amp; \cdots &amp; a_3b_n\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
a_nb_1 &amp; a_nb_2 &amp; a_nb_3 &amp; \cdots &amp; a_nb_n\\
\end{bmatrix} =
\mathbf{M}_{n \times n}$$`
---
### Vector Multiplication (cont.): Vector Outer Products (cont.)

### Important Notes

`$$\mathbf{a}\mathbf{b}^T  = \begin{bmatrix}
a_1b_1 &amp; a_1b_2 &amp; a_1b_3 &amp; \cdots &amp; a_1b_n\\
a_2b_1 &amp; a_2b_2 &amp; a_2b_3 &amp; \cdots &amp; a_2b_n\\
a_3b_1 &amp; a_3b_2 &amp; a_3b_3 &amp; \cdots &amp; a_3b_n\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
a_nb_1 &amp; a_nb_2 &amp; a_nb_3 &amp; \cdots &amp; a_nb_n\\
\end{bmatrix} =
\mathbf{M}_{n \times n}$$`

- `\(\mathbf{M}\)` is called a matrix, with dimensions defined
- `\(\mathbf{M}\)` comprises row vectors and column vectors
- because `\(\mathbf{M}\)` has the same number of rows and columns, it also has a diagonal vector
- the sum of the diagonal vector, called the **trace**, is the inner-product of `\(\mathbf{a}\)` and `\(\mathbf{b}\)`
---


### Matrices
A matrix is more than a vector outer-product (more precisely, a vector outer-product is merely one type of matrix).  A matrix is a collection of vectors, arranged in a specific way, such that linear algebra operations can be carried, systematically.  For example, the arrangement of vectors in a matrix indicates how to find a series of inner-products and display their results.

The most basic matrices for statistics are **data frames**.  In data frames, column vectors are variables and row vectors are observations.  We can demonstrate this easily in `R` with the `data.frame` and `matrix` functions.


```
##       y1 y2
## obs.1  2 -1
## obs.2  3 -2
## obs.3  2  0
## obs.4  5  0
## obs.5  6  1
## obs.6  8 -1
```
---

### Matrices (Cont.)



```
##       y1 y2
## obs.1  2 -1
## obs.2  3 -2
## obs.3  2  0
## obs.4  5  0
## obs.5  6  1
## obs.6  8 -1
```
Which is R's way of saying,

`$$\small{\mathbf{Y} = \begin{bmatrix}
2 &amp; -1 \\
3 &amp; -2 \\
2 &amp; 0 \\
5 &amp; 0 \\
6 &amp; 1 \\
8 &amp; -1 \\
\end{bmatrix}}$$`

`\(\mathbf{Y}\)` is a matrix and a data frame.  Row vectors are observations for the variables represented as column vectors. The dimensions of `\(\mathbf{Y}\)` are `\(n \times p\)` for the `\(n\)` observations of subjects for `\(p\)` variables.
---

### Matrices (Cont.)

#### This time with additional `R` code

```r
y1 &lt;- c(2, 3, 2, 5, 6, 8) # variable 1 with 6 observations
y2 &lt;- c(-1, -2, 0, 0, 1, -1) # variable 2 with 6 observations
*Y &lt;- data.frame(y1 = y1, y2 = y2)
rownames (Y) &lt;- paste("obs", 1:6, sep = ".") # giving our observations some names
Y
```

```
##       y1 y2
## obs.1  2 -1
## obs.2  3 -2
## obs.3  2  0
## obs.4  5  0
## obs.5  6  1
## obs.6  8 -1
```
---

### Matrix Addition, Subtraction, Multiplication

#### Matrix addition and subtraction
Matrix addition and subtraction is no different than vector addition and subtraction.  Matrices have to have *commensurate* dimensions (same `\(n \times p\)`).

#### Matrix multiplication
Matrix multiplication is nothing more than systematic calculation of vector inner-products and arrangement of these into precise corresponding elements of a new matrix.  Like vectors, inner dimensions must match and the product is defined by the outer dimensions.  The simplest way to define this is as follows

Let `\(\mathbf{X}\)` be an `\(n \times k\)` matrix and let `\(\mathbf{Y}\)` by an `\(n \times p\)` matrix, such that

`$$\mathbf{X} = \begin{bmatrix}
\mathbf{x}_1 &amp;
\mathbf{x}_2 &amp;
\cdots &amp;
\mathbf{x}_k 
\end{bmatrix}$$`

and

`$$\mathbf{Y} = \begin{bmatrix}
\mathbf{y}_1 &amp;
\mathbf{y}_2 &amp;
\cdots &amp; 
\mathbf{y}_p
\end{bmatrix}$$`

Note that each `\(\mathbf{x}_i\)` column vector is `\(n \times 1\)` in dimension for `\(k\)` vectors and each `\(\mathbf{y}_i\)` is `\(n \times 1\)` in dimension for `\(p\)` vectors.  Thus,
---
### Matrix Addition, Subtraction, Multiplication (Cont.)

`$$\mathbf{X} = \begin{bmatrix}
\mathbf{x}_1 &amp;
\mathbf{x}_2 &amp;
\cdots &amp;
\mathbf{x}_k 
\end{bmatrix}$$`

and 

`$$\mathbf{Y} = \begin{bmatrix}
\mathbf{y}_1 &amp;
\mathbf{y}_2 &amp;
\cdots &amp; 
\mathbf{y}_p
\end{bmatrix}$$`

and 

`$$\mathbf{X}^T\mathbf{Y} = \begin{bmatrix}
\mathbf{x}_1^T\mathbf{y}_1 &amp; \mathbf{x}_1^T\mathbf{y}_2 &amp; \cdots &amp; \mathbf{x}_1^T\mathbf{y}_p\\
\mathbf{x}_2^T\mathbf{y}_1 &amp; \mathbf{x}_2^T\mathbf{y}_2 &amp; \cdots &amp; \mathbf{x}_2^T\mathbf{y}_p\\
\vdots &amp; \vdots &amp; &amp; \vdots\\
\mathbf{x}_k^T\mathbf{y}_1 &amp; \mathbf{x}_k^T\mathbf{y}_2 &amp; \cdots &amp; \mathbf{x}_k^T\mathbf{y}_p\\
\end{bmatrix}$$`

The matrix product is a matrix with `\(k \times p\)` inner-products
---
### Matrix Multiplication (Cont.)

#### Matrix multiplication example (using R script)


```r
n &lt;- 50
p &lt;- 3
y1 &lt;- rnorm(50) # variable y1 with 50 observations
y2 &lt;- rnorm(50) # variable y2 with 50 observations
y3 &lt;- rnorm(50) # variable y2 with 50 observations
Y &lt;- data.frame(y1 = y1, y2 = y2, y3 = y3)  
rownames (Y) &lt;- paste("obs", 1:n, sep = ".") # giving our observations some names
dim(Y)
```

```
## [1] 50  3
```

---

### Matrix Multiplication (Cont.)

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f13e555b905a2e771f44" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f13e555b905a2e771f44">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["obs.1","obs.2","obs.3","obs.4","obs.5","obs.6","obs.7","obs.8","obs.9","obs.10","obs.11","obs.12","obs.13","obs.14","obs.15","obs.16","obs.17","obs.18","obs.19","obs.20","obs.21","obs.22","obs.23","obs.24","obs.25","obs.26","obs.27","obs.28","obs.29","obs.30","obs.31","obs.32","obs.33","obs.34","obs.35","obs.36","obs.37","obs.38","obs.39","obs.40","obs.41","obs.42","obs.43","obs.44","obs.45","obs.46","obs.47","obs.48","obs.49","obs.50"],[-1.8586,0.2866,-1.5143,0.1763,-0.6458,0.9829,-0.6307,-0.836,-1.3323,0.7561,-0.9378,0.1079,0.6004,1.5474,0.4363,1.5991,1.0503,1.1405,-0.3606,0.2153,-0.7237,0.0027,0.0414,-1.1218,0.3839,0.6746,0.2394,0.7541,0.91,-0.0471,-0.3809,-2.6391,-0.6936,0.0689,-0.917,-0.5882,1.0676,-0.6099,0.0766,-0.9873,0.7963,1.1892,-0.5803,-0.6622,0.1988,1.1682,1.1209,0.7186,0.2936,-0.4201],[0.8695,0.4068,1.9464,-0.18,1.6046,-1.3503,-2.8095,-1.6913,-2.2644,-0.8345,-0.2823,0.1872,0.2133,0.5273,0.0263,-0.7453,-0.003,0.3499,-0.2162,1.9505,0.0671,0.2489,0.4083,1.1417,-0.7207,0.2983,1.0459,-0.9975,0.7815,-0.0486,-0.5271,0.206,0.3753,1.5523,-0.8084,-0.0088,-0.2257,0.8322,-0.6604,-0.8217,1.1301,1.1324,-0.0891,-0.9582,0.6074,-0.4743,-2.6139,0.1937,0.5838,0.8193],[-1.6011,-0.0448,1.1635,-0.9407,-0.4924,-0.1071,0.726,-1.5008,0.3631,0.2771,-0.2456,-0.6083,-0.0977,2.2028,-0.3153,-2.1613,0.8365,0.4538,-0.7459,-2.4845,-0.1038,1.4114,0.0806,-0.6415,0.2591,0.1235,-1.3305,1.3233,0.1264,-0.057,-0.3322,0.9705,1.2175,1.3881,0.3616,-0.4566,-0.3989,-1.5409,-0.8617,-0.5938,-0.4396,-0.165,0.123,-1.4584,-1.7008,0.2873,-0.1895,-0.9828,0.7004,1.6467]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>y1<\/th>\n      <th>y2<\/th>\n      <th>y3<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "solarized-light",
"highlightLines": true,
"countIncrementalSlides": true,
"ratio": "16:9",
"self_contained": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
